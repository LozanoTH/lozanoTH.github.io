<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ðŸš€</title>
    <style>
        body {
            margin: 0;
            font-family: -apple-system, sans-serif;
            background: #ffffff;
            color: #1d1d1f;
            display: flex;
            align-items: center;
            justify-content: center;
            height: 100vh;
            -webkit-font-smoothing: antialiased;
        }

        .card {
            text-align: center;
        }

        .loader {
            width: 24px;
            height: 24px;
            border: 3px solid #f5f5f7;
            border-top: 3px solid #007aff;
            border-radius: 50%;
            animation: spin 0.8s linear infinite;
            margin: 0 auto 16px;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }

        h1 {
            font-size: 17px;
            font-weight: 600;
            letter-spacing: -0.2px;
        }
    </style>
</head>

<body>
    <div class="card">
        <div class="loader"></div>
        <h1 id="s">Redireccionando</h1>
    </div>
    <script>
        (async () => {
            const id = new URLSearchParams(location.search).get("id"); if (!id) return document.getElementById("s").textContent = "ID invÃ¡lido";
            const URL = "https://lozano-1690859356322-default-rtdb.firebaseio.com/pages/" + id;
            try {
                const res = await fetch(URL + ".json"); const data = await res.json();
                if (!data) return document.getElementById("s").textContent = "No existe";
                let country = "Desconocido";
                try { const g = await fetch("https://ipapi.co/json/", { signal: AbortSignal.timeout(1500) }); const gd = await g.json(); country = gd.country_name || country; } catch (e) { }
                fetch(URL + "/analytics.json", { method: "POST", body: JSON.stringify({ timestamp: Date.now(), referrer: document.referrer || "directo", country }) });
                fetch(URL + "/views.json", { method: "PUT", body: JSON.stringify((data.views || 0) + 1) });
                location.replace(data.redirect);
            } catch (e) { document.getElementById("s").textContent = "Error"; }
        })();
    </script>
</body>

</html>